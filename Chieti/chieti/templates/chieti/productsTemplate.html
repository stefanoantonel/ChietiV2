<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>

<!-- 
{% for o in some_list %}
    <tr class="{% cycle 'row1' rowvalue2 'row3' %}">
        ...
    </tr>
{% endfor %}
 -->


{% include 'chieti/mainHead.html' %}
    
<script type="text/javascript">

function Popup(status, id) {
	//Get
	var p = $("#img"+id);
	var offset = p.offset();

	//set
	$("#div"+id).offset({ top: offset.top, left: offset.left})
	console.log(document.getElementById("img"+id).offsetLeft);
     if (status == 1) {
        	console.log("id: "+id);
        	//$("#div"+id).removeAttr("display");
        	$("#div"+id).css("display","");
        	//$("#img"+id).attr("src","/static/chieti/productImages/"+id+".jpg");
    }
    else{
    	//setTimeout(function(){
    		//if (!$("#div"+id).is(':hover'))
    			console.log("id salida: "+id);
        		$("#div"+id).css("display", "none");
    	//}, 1000); 
    }
}

	$(document).ready(function() {
	  	console.log( "ready prod!" ) 		
		$('input[name=quantity]').change(function(){
            var ant=$(this).siblings("label[name=price]").attr("title")
			var cant=$(this).val()            
			var dsp=ant*cant
			console.log ('prec ant:', ant,' cant: ',cant,' dsp ',dsp 	)
			$(this).siblings('label[name=price]').html(dsp)
            
		})
        $('.add').click(function(){
            //ids=$(this).siblings(".ids").text()
            var ids= $(this).siblings("label[name=ids]").html()
            var quant= $(this).siblings('input[name=quantity]').val()
            console.log("ids:",ids,quant)
            $.ajax({
                url: '/chieti/addToOrder/',
                type: 'post', 
                data: {
                    'ids':ids,
                    'quantity':quant,
                },
                success: function(data) {
                    console.log("todo ok! AJAX")
                    console.log(data)
                }
            });    
        })
        
        

	});

</script>

	

</head>
<body>
<div>


<!-- img id="img10" alt="" src="/static/chieti/productImages/1.jpg" style="position:absolute; top:81px;> -->
<div class="allProducts">
{% for prod in todos %}
	<img id="img{{ prod.id }}" alt="" src="/static/chieti/productImages/{{ prod.id }}.jpg" class="productImg" onMouseover="Popup(1,{{ prod.id }})" onMouseout="Popup(0,{{ prod.id }})">
	 <div id="div{{ prod.id }}" style="position:absolute; width:150px;height:150px;">  <!-- style="position: absolute; display:none;" -->
    	<section >
        <img  src="/static/chieti/productImages/{{ prod.id }}.jpg" alt="" class="productImg">
        <label id="id1" name="ids" class="ids" hidden="hidden">{{ prod.id }}</label>
        <br/>
        <label name='name' class="product" >{{ prod.name }}</label>
        <br/>
        <label for='quantity'>Cant:</label>
        <input name='quantity' type="text" value="" >
        {{prod.measureUnit}}
        <br/>
        <label>Precio:</label>
        <label name='price' title="{{prod.salePrice}}">{{prod.salePrice}}</label>
        <button class="add">Agregar</button>
        <br/><br/>
        </section>
    </div>
	
	
{% endfor %}    
</div>


   
    
</div>

</body>
</html>